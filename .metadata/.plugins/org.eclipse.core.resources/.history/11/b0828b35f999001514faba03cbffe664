package david_suarez.david_suarez;

import java.io.IOException;

import org.apache.hadoop.io.DoubleWritable;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.NullWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;

public class HistogramMapper extends Mapper<DoubleWritable, NumbersTuple, IntWritable, IntWritable>{

	@Override
	public void map(DoubleWritable key, NumbersTuple value, Context context, Double n) throws IOException,
			InterruptedException {
		
		Double n = null; //TAKE VALUE FROM INPUT ARGUMENTS;
		Double number = key.get();
		Double min = value.getmin().get();
		Double max = value.getmax().get();
		
		Double bar = Math.floor((number - min)/((min - max)/n));
		
		if(number.equals(max)){
			context.write(new IntWritable(n - 1), new Integer(1));
		} else {
			context.write(new IntWritable(new Integer(bar.intValue())), new IntWritable(1));
		}
	}
}
